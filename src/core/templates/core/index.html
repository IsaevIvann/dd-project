{% extends "core/base.html" %}
{% load static %}

{% block title %}D&D — доставка багажа в Москве и области{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<style>
  :root{--ink:#0f172a;--muted:#64748b;--r:24px;}
  /* базовая типографика для этой страницы */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
  body{font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;}
  h1,h2,h3,h4{letter-spacing:-0.01em;}

  .pill{border-radius:999px}
  .card-dd{border:0;border-radius:var(--r);box-shadow:0 12px 30px rgba(16,24,40,.08);background:#fff;}

  /* HERO SLIDER — одинаковая высота и масштаб */
  .hero-slider{border-radius:32px;box-shadow:0 20px 50px rgba(16,24,40,.06);background:#fff;overflow:hidden}
  .hero-slide{
    display:grid;grid-template-columns:1.15fr .85fr;gap:32px;
    padding:3.5rem 2rem;
    min-height:560px;
    position:relative;
  }
  .hero-slide .left{display:flex;flex-direction:column;justify-content:center;max-width:720px}
  .hero-slide .right{display:flex;flex-direction:column;align-items:center;justify-content:center}
  .hero-ill{border-radius:24px;background:#fff;box-shadow:0 10px 26px rgba(16,24,40,.08);padding:1.25rem}
  .hero-ill img{display:block;width:100%;max-width:520px;aspect-ratio:4/3;object-fit:contain;border-radius:16px}
  .hero-title{font-weight:800;font-size:clamp(32px,3.8vw,48px);line-height:1.1;color:var(--ink);margin:0 0 12px}
  .hero-sub{font-size:1.125rem;color:var(--muted);margin:0 0 24px}
  .accent{color:#0d6efd}
  .hero-actions{display:flex;gap:12px;flex-wrap:wrap}
  .hero-actions .btn{border-radius:999px;position:relative;z-index:2;pointer-events:auto}

  .hero-caption{min-height:22px}
  .hero-swiper{overflow:hidden}
  .swiper-pagination{position:absolute;left:0;right:0;bottom:16px;z-index:3}
  .swiper-button-prev,.swiper-button-next{display:none!important}
  .swiper-pagination-bullet{opacity:.4;background:#1b2a4a}
  .swiper-pagination-bullet-active{opacity:1;background:#0d6efd}

  @media (max-width:992px){
    .hero-slide{grid-template-columns:1fr;padding:2rem;min-height:auto}
    .hero-title{font-size:clamp(26px,6vw,36px)}
  }
</style>
{% endblock %}

{% block content %}

<!-- HERO SLIDER -->
<section class="mb-5">
  <div class="swiper hero-swiper hero-slider" aria-label="Промо-слайдер D&D">
    <div class="swiper-wrapper">

      <!-- Слайд 1 -->
      <div class="swiper-slide">
        <article class="hero-slide">
          <div class="left">
            <h1 class="hero-title">
              Доставка багажа в Москве и области — путешествуйте <span class="accent">налегке</span>
            </h1>
            <p class="hero-sub">
              Представитель приедет, упакует и заберет чемоданы. Мы сохраним их на складе и привезём
              <span class="fw-semibold">в удобное для вас место</span>: аэропорт, вокзал или отель — точно в срок.
            </p>
            <div class="hero-actions">
              <a href="{% url 'order_create' %}" class="btn btn-lg btn-primary px-4"><i class="bi bi-bag-check"></i> Оставить заявку</a>
              <a href="#tariffs" class="btn btn-lg btn-outline-primary px-4"><i class="bi bi-tags"></i> Тарифы</a>
            </div>
          </div>
          <div class="right">
            <div class="hero-ill text-center">
              <img src="{% static 'core/img/dnd-hero.png' %}"
                   alt="Drop & Delivery — доставка багажа: забор, хранение и доставка"
                   class="img-fluid" loading="eager" fetchpriority="high" decoding="async">
              <div class="small text-muted mt-2 hero-caption">Ваш багаж — под защитой и уже в пути ✈️</div>
            </div>
          </div>
        </article>
      </div>

      <!-- Слайд 2 -->
      <div class="swiper-slide">
        <article class="hero-slide">
          <div class="left">
            <span class="badge text-primary bg-opacity-10 border border-primary-subtle rounded-pill px-3 py-2 mb-2">
              <i class="bi bi-bag me-1"></i> Хранение с доставкой
            </span>
            <h2 class="hero-title">Хранение багажа в Москве — <span class="accent">без очередей и поездок</span></h2>
            <p class="hero-sub">
              Заберём чемоданы у двери, опечатаем и бережно сохраним. В нужное время привезём в аэропорт, на вокзал или по адресу — точно в срок.
            </p>
            <div class="hero-actions">
              <a href="{% url 'order_create' %}" class="btn btn-lg btn-primary px-4"><i class="bi bi-send me-1"></i>Оставить заявку</a>
              <a href="{% url 'index' %}#tariffs" class="btn btn-lg btn-outline-primary px-4"><i class="bi bi-tag me-1"></i>Тарифы</a>
            </div>
          </div>
          <div class="right">
            <div class="hero-ill text-center">
              <img src="{% static 'core/img/dnd_storage.png' %}"
                   alt="Хранение багажа с доставкой по Москве"
                   class="img-fluid" loading="lazy" decoding="async">
              <div class="small text-muted mt-2 hero-caption">Ваш багаж — под присмотром и уже в пути ✈️</div>
            </div>
          </div>
        </article>
      </div>

      <!-- Слайд 3 -->
      <div class="swiper-slide">
        <article class="hero-slide">
          <div class="left">
            <h2 class="hero-title">Почему нас выбирают: <span class="accent">от двери до двери</span></h2>
            <p class="hero-sub">
              Аккуратно упакуем и опечатаем багаж, оформим акт, храним на охраняемом складе и доставим в нужную точку — аэропорт, вокзал или по адресу. Отслеживаем рейсы и подстраиваемся под время.
            </p>
            <div class="hero-actions">
              <a href="{% url 'order_create' %}" class="btn btn-lg btn-primary px-4"><i class="bi bi-bag-check"></i> Оставить заявку</a>
              <a href="{% url 'faq' %}" class="btn btn-lg btn-outline-primary px-4">Частые вопросы</a>
            </div>
          </div>
          <div class="right">
            <div class="hero-ill text-center">
              <img src="{% static 'core/img/dnd-hero.png' %}"
                   alt="D&D — доставка багажа от двери до двери"
                   class="img-fluid" loading="lazy">
              <div class="small text-muted mt-2 hero-caption">Страхование до 30 000 ₽ включено</div>
            </div>
          </div>
        </article>
      </div>

    </div>

    <!-- Пагинация (точки) -->
    <div class="swiper-pagination"></div>
  </div>
</section>

<!-- ШАГИ -->
<section class="p-4 p-md-5 mb-5" style="border-radius:28px;background:#f7fbff">
  <h3 class="fw-bold text-center mb-4">Как работает услуга доставки багажа</h3>
  <div class="row row-cols-2 row-cols-md-3 row-cols-xl-5 g-4 justify-content-center">
    <div class="col text-center">
      <div class="icon-wrap icon-blue mx-auto mb-3"><i class="bi bi-pencil-square fs-3"></i></div>
      <h6 class="mb-1">1. Заявка</h6>
      <div class="text-muted small">Оставляете на сайте или в мессенджере.</div>
    </div>
    <div class="col text-center">
      <div class="icon-wrap icon-green mx-auto mb-3"><i class="bi bi-person-check fs-3"></i></div>
      <h6 class="mb-1">2. Встреча</h6>
      <div class="text-muted small">Приезжает представитель с документами и упаковкой.</div>
    </div>
    <div class="col text-center">
      <div class="icon-wrap icon-cyan mx-auto mb-3"><i class="bi bi-lock fs-3"></i></div>
      <h6 class="mb-1">3. Опечатываем</h6>
      <div class="text-muted small">Пломбируем, фотографируем, выдаём квитанцию.</div>
    </div>
    <div class="col text-center">
      <div class="icon-wrap icon-amber mx-auto mb-3"><i class="bi bi-geo-alt fs-3"></i></div>
      <h6 class="mb-1">4. Доставка</h6>
      <div class="text-muted small">Привозим по адресу, в аэропорт или на вокзал.</div>
    </div>
    <div class="col text-center">
      <div class="icon-wrap icon-blue mx-auto mb-3"><i class="bi bi-credit-card fs-3"></i></div>
      <h6 class="mb-1">5. Оплата</h6>
      <div class="text-muted small">Проверяете целостность и сохранность — и только после этого оплачиваете.</div>
    </div>
  </div>
</section>

<!-- ТАРИФЫ + КАЛЬКУЛЯТОР -->
<section id="tariffs" class="mb-5">
  <style>
    .dd-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid #d6e4ff;background:#ecf3ff;color:#1e3a8a;font-size:12px}
    .dd-divider{height:1px;background:#eef2ff;margin:8px 0 10px}
    .dd-calc .form-control,.dd-calc .form-select{border-radius:12px;padding:.8rem .9rem;border-color:#e5e7eb}
    .dd-calc .form-control:focus,.dd-calc .form-select:focus{border-color:#2563eb;box-shadow:0 0 0 .35rem rgba(37,99,235,.15)}
    .dd-total{font-weight:800;font-size:1.6rem;color:var(--ink)}
    .dd-muted{color:var(--muted)}
  </style>

  <h3 class="fw-bold text-center mb-4">Тарифы на доставку багажа</h3>

  <div class="row g-4">
    <div class="col-md-4">
      <div class="card-dd p-4 h-100 text-center">
        <div class="small tariff-title mb-1">1–3 единицы</div>
        <div class="tariff-price mb-2">от 3 500 <span class="rub">₽</span></div>
        <div class="dd-divider"></div>
        <div class="text-muted small">Забор → хранение → доставка</div>
        <div class="mt-2"><span class="dd-chip">1 сутки хранения включены</span></div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card-dd p-4 h-100 text-center">
        <div class="small tariff-title mb-1">4–6 единиц</div>
        <div class="tariff-price mb-2">от 4 000 <span class="rub">₽</span></div>
        <div class="dd-divider"></div>
        <div class="text-muted small">Забор → хранение → доставка</div>
        <div class="mt-2"><span class="dd-chip">1 сутки хранения включены</span></div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card-dd p-4 h-100 text-center">
        <div class="small tariff-title mb-1">7+ единиц</div>
        <div class="tariff-price mb-2">4 500 <span class="rub">₽</span> + 500 ₽/за каждую доп. ед.</div>
        <div class="dd-divider"></div>
        <div class="text-muted small">Забор → хранение → доставка</div>
        <div class="mt-2"><span class="dd-chip">1 сутки хранения бесплатно</span></div>
      </div>
    </div>
  </div>
</section>

<section class="mb-5 mt-4 mt-lg-5">
  <div class="surface p-4">
    <h2 class="h4 mb-3">Калькулятор стоимости доставки багажа</h2>

    <form class="row g-3 align-items-end">
      <div class="col-md-4">
        <label class="form-label">Количество единиц</label>
        <input type="number" min="1" value="2" class="form-control" />
      </div>
      <div class="col-md-4">
        <label class="form-label">Дней хранения (включая 1-е)</label>
        <input type="number" min="1" value="1" class="form-control" />
      </div>
      <div class="col-md-4">
        <label class="form-label">Зона</label>
        <select class="form-select">
          <option selected>Зона 1 — Москва, все аэропорты (×1.0)</option>
          <option>Зона 1.5 — Московская область (×1.5)</option>
        </select>
      </div>

      <div class="col-12 d-flex justify-content-end">
        <button type="button" class="btn btn-primary">
          <i class="bi bi-calculator me-1"></i> Рассчитать
        </button>
      </div>
    </form>

    <div class="small text-secondary mt-2">
      Базовая стоимость умножается на коэффициент зоны. Хранение — единый тариф: 1-е сутки бесплатно, далее 500 ₽/сутки за весь заказ.
    </div>

    <hr class="my-4">

    <div class="row gx-4 gy-3">
      <div class="col-md-6">
        <div class="fw-semibold small text-uppercase text-muted mb-1">Зона 1 (коэффициент: ×1.0)</div>
        <div class="h6 mb-1">Москва, все аэропорты и вокзалы</div>
      </div>
      <div class="col-md-6">
        <div class="fw-semibold small text-uppercase text-muted mb-1">Зона 1.5 (коэффициент: ×1.5)</div>
        <div class="h6 mb-1">Московская область</div>
      </div>
    </div>
  </div>
</section>

{% include "core/partials/_faq_block.html" %}

<section class="card-dd p-4 p-md-5 mb-4 text-center">
  <h4 class="fw-bold mb-2">Путешествуйте по Москве налегке</h4>
  <div class="text-muted mb-3">Багаж — на нас. Доставим точно ко времени!</div>
  <a href="{% url 'order_create' %}" class="btn btn-lg btn-primary pill px-4"><i class="bi bi-bag"></i> Оставить заявку</a>
  <div class="mt-3">
    <a href="{% url 'faq' %}" class="btn btn-outline-primary pill px-4">Смотреть все вопросы</a>
  </div>
</section>

<section class="card-dd p-4 mt-4">
  <h5 class="fw-bold mb-2">Популярные направления</h5>
  <div class="d-flex flex-wrap gap-2">
    <a class="btn btn-light border pill" href="{% url 'aero' 'svo' %}">Доставка в Шереметьево</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'dme' %}">Доставка в Домодедово</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'vko' %}">Доставка в Внуково</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'zia' %}">Доставка в Жуковский</a>
  </div>
</section>

{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  const hero = new Swiper('.hero-swiper', {
    loop: true,
    speed: 650,
    effect: 'fade',
    fadeEffect: { crossFade: true },
    autoplay: { delay: 3000, disableOnInteraction: false }, // 3 секунды
    pagination: { el: '.swiper-pagination', clickable: true },
    preventClicks: false,
    preventClicksPropagation: false,
    allowTouchMove: true,
    simulateTouch: true,
  });
  const el = document.querySelector('.hero-swiper');
  el.addEventListener('mouseenter', () => hero.autoplay.stop());
  el.addEventListener('mouseleave', () => hero.autoplay.start());
  el.addEventListener('focusin', () => hero.autoplay.stop());
  el.addEventListener('focusout', () => hero.autoplay.start());
</script>
{% endblock %}
