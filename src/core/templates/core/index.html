{% extends "core/base.html" %}
{% load static %}

{% block title %}Доставка и хранение багажа в Москве | Drop & Delivery{% endblock %}

{% block extra_head %}
  <meta name="description"
        content="Доставка и хранение багажа в Москве — заберём чемоданы у двери, опечатаем, сохраним и привезём ко времени в аэропорт, на вокзал или по адресу. Первые сутки хранения бесплатны. Работаем круглосуточно.">

  <!-- Open Graph -->
  <meta property="og:title" content="Drop & Delivery — доставка и хранение багажа в Москве и области">
  <meta property="og:description" content="Заберём, опечатаем, сохраним и доставим багаж ко времени — в аэропорт, по адресу или на вокзал.">
  <meta property="og:url" content="{{ request.scheme }}://{{ request.get_host }}{{ request.path }}">
  <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{% static 'core/img/logo-512.png' %}">

  <!-- ⭐ JSON-LD: HowTo -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"HowTo",
    "name":"Как оформить доставку и хранение багажа",
    "description":"Пошаговая инструкция: от оформления заявки до доставки багажа по адресу или в аэропорт.",
    "step":[
      {"@type":"HowToStep","name":"Заявка","text":"Оставьте заявку на сайте или в мессенджере. Мы согласуем адрес, время и количество багажа."},
      {"@type":"HowToStep","name":"Встреча","text":"Представитель приедет с документами и упаковкой. Пломбируем и фотографируем багаж."},
      {"@type":"HowToStep","name":"Хранение","text":"Багаж помещается на охраняемый склад. Первые сутки хранения включены во все тарифы."},
      {"@type":"HowToStep","name":"Доставка","text":"Доставляем багаж в аэропорт, на вокзал, в отель или по адресу — строго ко времени."},
      {"@type":"HowToStep","name":"Оплата","text":"Оплата производится после проверки целостности и комплектности багажа."}
    ]
  }
  </script>

  <!-- ⭐ JSON-LD: Service (главная услуга) -->
  <script type="application/ld+json">
  {
   "@context":"https://schema.org",
   "@type":"Service",
   "name":"Доставка и хранение багажа",
   "serviceType":"Доставка багажа от двери до двери + складское хранение",
   "provider":{"@id":"{{ SITE_URL }}/#organization"},
   "areaServed":["Москва","Московская область"],
   "url":"{{ SITE_URL }}/",
   "offers":{
     "@type":"AggregateOffer",
     "priceCurrency":"RUB",
     "lowPrice":"3500",
     "highPrice":"7000",
     "offerCount":"3",
     "offers":[
        {
          "@type":"Offer",
          "name":"1–3 единицы",
          "price":"3500",
          "priceCurrency":"RUB",
          "availability":"https://schema.org/InStock",
          "url":"{{ SITE_URL }}/#tariffs"
        },
        {
          "@type":"Offer",
          "name":"4–6 единиц",
          "price":"4000",
          "priceCurrency":"RUB",
          "availability":"https://schema.org/InStock",
          "url":"{{ SITE_URL }}/#tariffs"
        },
        {
          "@type":"Offer",
          "name":"7+ единиц",
          "price":"4500",
          "priceCurrency":"RUB",
          "availability":"https://schema.org/InStock",
          "url":"{{ SITE_URL }}/#tariffs"
        }
     ]
   }
  }
  </script>

  <!-- ⭐ JSON-LD: Breadcrumbs — до главной -->
  <script type="application/ld+json">
  {
   "@context": "https://schema.org",
   "@type": "BreadcrumbList",
   "itemListElement": [
     {
       "@type": "ListItem",
       "position": 1,
       "name": "Главная",
       "item": "https://www.drop-delivery.ru/"
     }
   ]
  }
  </script>

  <style>
    :root{--ink:#0f172a;--muted:#64748b;--r:24px;}
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    body{font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;}
    h1,h2,h3,h4{letter-spacing:-0.01em;}
    .pill{border-radius:999px}
    .card-dd{border:0;border-radius:var(--r);box-shadow:0 12px 30px rgba(16,24,40,.08);background:#fff;}

    .hero-wrap{
      border-radius:32px;
      box-shadow:0 20px 50px rgba(16,24,40,.06);
      background:#fff;
      padding:3.5rem 2rem;
      margin-bottom:3rem;
      display:grid;
      grid-template-columns:1.15fr .85fr;
      gap:32px;
      align-items:center;
    }
    .hero-wrap .left{display:flex;flex-direction:column;justify-content:center;max-width:720px}
    .hero-wrap .right{display:flex;flex-direction:column;align-items:center;justify-content:center}
    .hero-ill{border-radius:24px;background:#fff;box-shadow:0 10px 26px rgba(16,24,40,.08);padding:1.25rem}
    .hero-ill img{display:block;width:100%;max-width:520px;aspect-ratio:4/3;object-fit:contain;border-radius:16px}
    .hero-title{font-weight:800;font-size:clamp(32px,3.8vw,48px);line-height:1.1;color:var(--ink);margin:0 0 12px}
    .hero-sub{font-size:1.125rem;color:var(--muted);margin:0 0 24px}
    .accent{color:#0d6efd}
    .hero-actions{display:flex;gap:12px;flex-wrap:wrap}
  </style>
{% endblock %}

{% block content %}

<!-- HERO -->
<section class="mb-5">
  <article class="hero-wrap">
    <div class="left">
      <h1 class="hero-title">
        Доставка багажа в Москве — быстро, безопасно и ко времени
      </h1>
      <p class="hero-sub">
        Заберём чемоданы у двери, опечатаем, сохраним на складе и привезём в аэропорт, на вокзал или по адресу. 1 сутки хранения уже включены.
      </p>
      <div class="hero-actions">
        <a href="{% url 'order_create' %}" class="btn btn-lg btn-primary px-4">
          <i class="bi bi-bag-check"></i> Оставить заявку
        </a>
        <a href="#tariffs" class="btn btn-lg btn-outline-primary px-4">
          <i class="bi bi-tags"></i> Тарифы
        </a>
      </div>
    </div>

    <div class="right">
      <div class="hero-ill text-center">
        <img src="{% static 'core/img/dnd-hero.png' %}"
             alt="Drop & Delivery — доставка и хранение багажа"
             class="img-fluid" loading="eager" fetchpriority="high">
      </div>
    </div>
  </article>
</section>

<!-- ШАГИ -->
<section class="p-4 p-md-5 mb-5" style="border-radius:28px;background:#f7fbff">
  <h2 class="fw-bold text-center mb-4">Как работает услуга</h2>
  <div class="row row-cols-2 row-cols-md-3 row-cols-xl-5 g-4 justify-content-center">
    <div class="col text-center">
      <i class="bi bi-pencil-square fs-3 mb-2"></i>
      <h6 class="mb-1">1. Заявка</h6>
      <div class="text-muted small">Оставьте онлайн или в мессенджере</div>
    </div>
    <div class="col text-center">
      <i class="bi bi-person-check fs-3 mb-2"></i>
      <h6 class="mb-1">2. Встреча</h6>
      <div class="text-muted small">Представитель приедет вовремя</div>
    </div>
    <div class="col text-center">
      <i class="bi bi-lock fs-3 mb-2"></i>
      <h6 class="mb-1">3. Опечатываем</h6>
      <div class="text-muted small">Пломбирум и фотографируем багаж</div>
    </div>
    <div class="col text-center">
      <i class="bi bi-geo-alt fs-3 mb-2"></i>
      <h6 class="mb-1">4. Доставка</h6>
      <div class="text-muted small">В аэропорт, отель, вокзал, адрес</div>
    </div>
    <div class="col text-center">
      <i class="bi bi-credit-card fs-3 mb-2"></i>
      <h6 class="mb-1">5. Оплата</h6>
      <div class="text-muted small">После проверки целостности</div>
    </div>
  </div>
</section>

<!-- СВЯЗАТЬСЯ С НАМИ -->
<section class="card-dd p-4 p-md-5 mb-5">
  <div class="row g-3 align-items-center">
    <div class="col-md-5">
      <h2 class="h5 fw-bold mb-1">Связаться с нами</h2>
      <div class="text-muted small mb-2">Ответим за минуту, подберём удобное время.</div>
      <a href="{% url 'contacts' %}" class="small">Все контакты →</a>
    </div>
    <div class="col-md-7">
      <div class="d-flex flex-wrap gap-2 justify-content-md-end">
        <a href="tel:+79936000879" class="btn btn-outline-secondary btn-sm"><i class="bi bi-telephone"></i> +7 993 600-08-79</a>
        <a href="mailto:dropdeliv@ya.ru" class="btn btn-outline-dark btn-sm"><i class="bi bi-envelope"></i> Email</a>
        <a href="https://t.me/dropdeliv" class="btn btn-outline-primary btn-sm"><i class="bi bi-telegram"></i> Telegram</a>
        <a href="https://wa.me/79936000879" class="btn btn-outline-success btn-sm"><i class="bi bi-whatsapp"></i> WhatsApp</a>
      </div>
    </div>
  </div>
</section>

<!-- ТАРИФЫ -->
<section id="tariffs" class="mb-5">
  <h2 class="fw-bold text-center mb-4">Тарифы</h2>

  <div class="row g-4">
    <div class="col-md-4">
      <div class="card-dd p-4 text-center h-100">
        <div class="small">1–3 единицы</div>
        <div class="tariff-price mb-2">от 3 500 ₽</div>
        <div class="text-muted small">Забор • хранение • доставка</div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card-dd p-4 text-center h-100">
        <div class="small">4–6 единиц</div>
        <div class="tariff-price mb-2">от 4 000 ₽</div>
        <div class="text-muted small">Забор • хранение • доставка</div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card-dd p-4 text-center h-100">
        <div class="small">7+ единиц</div>
        <div class="tariff-price mb-2">от 4 500 ₽</div>
        <div class="text-muted small">+500 ₽ за штуку сверху</div>
      </div>
    </div>
  </div>
</section>

<!-- КАЛЬКУЛЯТОР -->
<section class="mb-5 mt-4 mt-lg-5">
  <div class="card-dd p-4 dd-calc">

    <h2 class="h5 mb-3">Калькулятор стоимости доставки</h2>

    <form id="dd-calc-form" class="row gx-3 gy-3 align-items-end" novalidate>
      <div class="col-12 col-md-3 col-lg-2">
        <label for="calcUnits" class="form-label">Количество</label>
        <input id="calcUnits" type="number" min="1" value="2" class="form-control" />
      </div>

      <div class="col-12 col-md-3 col-lg-2">
        <label for="calcDays" class="form-label">Дней хранения</label>
        <input id="calcDays" type="number" min="1" value="1" class="form-control" />
      </div>

      <div class="col-12 col-md-4 col-lg-4">
        <label for="calcZone" class="form-label">Зона</label>
        <select id="calcZone" class="form-select">
          <option value="1">Москва, аэропорты</option>
          <option value="1.5">Московская область</option>
        </select>
      </div>

      <div class="col-12 col-md-2 col-lg-4 text-md-end">
        <button id="dd-calc-btn" type="button" class="btn btn-primary w-100 w-md-auto">
          <i class="bi bi-calculator me-1"></i> Рассчитать
        </button>
      </div>
    </form>

    <div id="dd-calc-result" class="alert alert-light border mt-3">
      <div class="dd-total">0 ₽</div>
      <div id="dd-calc-breakdown" class="text-secondary small mt-1"></div>
    </div>

  </div>
</section>

<!-- SEO-ТЕКСТ -->
<section id="about-service" class="card-dd p-4 p-md-5 mb-5">
  <h2 class="h5 fw-bold mb-3">Удобная доставка багажа в Москве</h2>
  <p class="text-secondary">
    Drop & Delivery позволяет путешествовать налегке: мы забираем багаж, упаковываем, пломбируем, храним и доставляем точно в срок.
    Услуга подходит туристам, семьям, транзитным пассажирам и тем, кто переезжает по городу.
  </p>
  <p class="text-secondary">
    Каждая единица пломбируется и фиксируется в акте. Первые сутки хранения включены. Доставка — по Москве, в аэропорты,
    вокзалы и по адресам в Московской области.
  </p>
</section>

<!-- ТИЗЕР FAQ -->
<section class="card-dd p-4 p-md-5 mb-4 text-center">
  <h2 class="h5 fw-bold mb-2">Ответы на частые вопросы</h2>
  <div class="text-muted mb-3">Подробные условия, безопасность и расчёты — в разделе FAQ.</div>
  <a href="{% url 'faq' %}" class="btn btn-outline-primary pill px-4">Смотреть все</a>
</section>

<!-- ПОПУЛЯРНЫЕ НАПРАВЛЕНИЯ -->
<section class="card-dd p-4 mt-4 mb-4">
  <h2 class="h5 fw-bold mb-2">Популярные направления</h2>
  <div class="d-flex flex-wrap gap-2">
    <a class="btn btn-light border pill" href="{% url 'aero' 'svo' %}">Шереметьево</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'dme' %}">Домодедово</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'vko' %}">Внуково</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'zia' %}">Жуковский</a>
  </div>
</section>

<!-- СМОТРИТЕ ТАКЖЕ -->
<section class="card-dd p-4 p-md-5 mb-5">
  <h2 class="h5 fw-bold mb-3">Смотрите также</h2>
  <div class="d-flex flex-wrap gap-2">
    <a class="btn btn-light border pill" href="{% url 'storage_moscow' %}">Хранение багажа</a>
    <a class="btn btn-light border pill" href="{% url 'benefits' %}">Почему мы — от двери до двери</a>
    <a class="btn btn-light border pill" href="{% url 'faq' %}">Частые вопросы</a>
    <a class="btn btn-light border pill" href="{% url 'aero' 'svo' %}">Доставка в Шереметьево</a>
  </div>
</section>

{% endblock %}

{% block extra_scripts %}
<script>
  (function(){
    const units = document.getElementById('calcUnits');
    const days = document.getElementById('calcDays');
    const zone = document.getElementById('calcZone');
    const btn = document.getElementById('dd-calc-btn');

    const totalEl = document.querySelector('#dd-calc-result .dd-total');
    const breakdownEl = document.getElementById('dd-calc-breakdown');

    const fmt = n => n.toLocaleString('ru-RU');

    function basePrice(u){
      if (u <= 3) return 3500;
      if (u <= 6) return 4000;
      return 4500 + 500*(u-7);
    }

    function storageCost(d){
      return Math.max(0, d - 1) * 500;
    }

    function calc(){
      const u = Math.max(1, parseInt(units.value));
      const d = Math.max(1, parseInt(days.value));
      const k = parseFloat(zone.value);

      const base = basePrice(u);
      const move = Math.round(base * k);
      const store = storageCost(d);
      const total = move + store;

      totalEl.textContent = fmt(total) + ' ₽';
      breakdownEl.textContent =
        `Доставка: ${fmt(base)} ₽ × ${k} = ${fmt(move)} ₽. Хранение: ${fmt(store)} ₽.`;
    }

    btn.addEventListener('click', calc);
    units.addEventListener('input', calc);
    days.addEventListener('input', calc);
    zone.addEventListener('change', calc);

    calc();
  })();
</script>
{% endblock %}
